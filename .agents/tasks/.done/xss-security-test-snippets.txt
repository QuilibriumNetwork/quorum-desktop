â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  XSS SECURITY TEST SNIPPETS
  Safe test cases for validating XSS prevention
  Created: 2025-11-08
  Updated: 2025-11-08 - Reflect current implementation (NO rehype-raw/sanitize)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš ï¸  DISCLAIMER: These are SAFE test snippets designed for local testing only.
    They use harmless JavaScript like console.log() instead of malicious code.
    Test in a controlled environment (localhost) only.

ğŸ“  CURRENT IMPLEMENTATION:
    - NO rehype-raw plugin â†’ All user-typed HTML is escaped as literal text
    - Placeholder tokens (<<<MENTION_USER:address>>>) for safe mention rendering
    - Input validation blocks < > " ' in display names and space names
    - ReactMarkdown escapes HTML by default (secure)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SECTION 1: DISPLAY NAME / SPACE NAME INPUT VALIDATION TESTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

These should be BLOCKED by input validation (error message shown):
-----------------------------------------------------------------------------

Test 1: Basic Script Tag
-------------------------
"><script>console.log('XSS')</script>

Expected: âŒ Validation error: "Display name cannot contain < > " ' characters"
Reason: Contains < > " '


Test 2: Attribute Breaking with Single Quote
---------------------------------------------
'><script>console.log('XSS')</script>

Expected: âŒ Validation error
Reason: Contains < > '


Test 3: Image with onerror
---------------------------
"><img src=x onerror=console.log('XSS')>

Expected: âŒ Validation error
Reason: Contains < > " '


Test 4: HTML Comment Injection
-------------------------------
--><script>console.log('XSS')</script><!--

Expected: âŒ Validation error
Reason: Contains < > '


Test 5: SVG with onload
------------------------
"><svg onload=console.log('XSS')>

Expected: âŒ Validation error
Reason: Contains < > "


Test 6: Data URI JavaScript
----------------------------
"><a href="javascript:console.log('XSS')">click</a>

Expected: âŒ Validation error
Reason: Contains < > " '


Test 7: Style Tag Injection
----------------------------
"><style>body{background:red}</style>

Expected: âŒ Validation error
Reason: Contains < > "


Test 8: Iframe Injection
-------------------------
"><iframe src="javascript:console.log('XSS')"></iframe>

Expected: âŒ Validation error
Reason: Contains < > " '


Test 9: Meta Refresh
---------------------
"><meta http-equiv="refresh" content="0;url=data:text/html,<script>console.log('XSS')</script>">

Expected: âŒ Validation error
Reason: Contains < > " '


Test 10: Object/Embed Tag
--------------------------
"><object data="data:text/html,<script>console.log('XSS')</script>"></object>

Expected: âŒ Validation error
Reason: Contains < > " '


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

These should be ALLOWED (safe characters):
-----------------------------------------------------------------------------

Test 11: Ampersand
------------------
Tom & Jerry

Expected: âœ… Accepted
Reason: & is safe


Test 12: Currency Symbols
--------------------------
Price: $100 â‚¬50 Â¥1000 Â£75

Expected: âœ… Accepted
Reason: Currency symbols are safe


Test 13: Emojis
----------------
Cool User ğŸ‰ğŸ‘ğŸ”¥

Expected: âœ… Accepted
Reason: Emojis are safe


Test 14: International Characters
----------------------------------
JosÃ© GarcÃ­a åŒ—äº¬ç”¨æˆ· Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ø±Ø¨ÙŠ Ğ’Ğ»Ğ°Ğ´Ğ¸Ğ¼Ğ¸Ñ€

Expected: âœ… Accepted
Reason: All language characters allowed


Test 15: Accented Letters
--------------------------
CafÃ© RenÃ© ZÃ¼rich SÃ£o Paulo

Expected: âœ… Accepted
Reason: Accented letters are safe


Test 16: Special Punctuation
-----------------------------
User-Name_123 (Test) [Admin] @company.com #hashtag

Expected: âœ… Accepted
Reason: These punctuation marks are safe


Test 17: Math Symbols
----------------------
2+2=4 10%off 5*3=15

Expected: âœ… Accepted
Reason: Math symbols are safe


Test 18: Underscores and Hyphens
---------------------------------
Super_User-2024

Expected: âœ… Accepted
Reason: Common safe characters


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SECTION 2: MESSAGE MARKDOWN RENDERER TESTS (Message.tsx)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Type these in a message to test if HTML is escaped as literal text:
-----------------------------------------------------------------------------
NOTE: We do NOT use rehype-raw, so ALL user-typed HTML is escaped by default

Test 19: Basic Script Tag in Message
-------------------------------------
Hello <script>console.log('XSS from message')</script> World

Expected: âœ… Renders as: "Hello <script>console.log('XSS from message')</script> World"
Reason: ReactMarkdown escapes HTML by default (no rehype-raw plugin)


Test 20: Image with onerror in Message
---------------------------------------
Check this out: <img src=x onerror=console.log('XSS')>

Expected: âœ… Renders as: "Check this out: <img src=x onerror=console.log('XSS')>"
Reason: ReactMarkdown escapes HTML by default


Test 21: Iframe Injection in Message
-------------------------------------
<iframe src="javascript:console.log('XSS')"></iframe>

Expected: âœ… Renders as: "<iframe src="javascript:console.log('XSS')"></iframe>"
Reason: ReactMarkdown escapes HTML by default


Test 22: SVG with Script
-------------------------
<svg><script>console.log('XSS')</script></svg>

Expected: âœ… Renders as: "<svg><script>console.log('XSS')</script></svg>"
Reason: ReactMarkdown escapes HTML by default


Test 23: Div with onclick
--------------------------
<div onclick="console.log('XSS')">Click me</div>

Expected: âœ… Renders as: "<div onclick="console.log('XSS')">Click me</div>"
Reason: ReactMarkdown escapes HTML by default


Test 24: Anchor Tag with javascript: URL
-----------------------------------------
<a href="javascript:console.log('XSS')">Click here</a>

Expected: âœ… Renders as: "<a href="javascript:console.log('XSS')">Click here</a>"
Reason: ReactMarkdown escapes HTML by default (NOT clickable link)


Test 25: Style Tag
-------------------
<style>body{background:red !important;}</style>

Expected: âœ… Renders as: "<style>body{background:red !important;}</style>"
Reason: ReactMarkdown escapes HTML by default


Test 26: Meta Tag
------------------
<meta http-equiv="refresh" content="0;url=data:text/html,test">

Expected: âœ… Renders as: "<meta http-equiv="refresh" content="0;url=data:text/html,test">"
Reason: ReactMarkdown escapes HTML by default


Test 27: Object/Embed Tag
--------------------------
<object data="data:text/html,test"></object>

Expected: âœ… Renders as: "<object data="data:text/html,test"></object>"
Reason: ReactMarkdown escapes HTML by default


Test 28: Base Tag
------------------
<base href="http://evil.com/">

Expected: âœ… Renders as: "<base href="http://evil.com/">"
Reason: ReactMarkdown escapes HTML by default


Test 29: Link Tag
------------------
<link rel="stylesheet" href="http://evil.com/style.css">

Expected: âœ… Renders as: "<link rel="stylesheet" href="http://evil.com/style.css">"
Reason: ReactMarkdown escapes HTML by default


Test 30: Form Tag
-----------------
<form action="http://evil.com"><input type="password"></form>

Expected: âœ… Renders as: "<form action="http://evil.com"><input type="password"></form>"
Reason: ReactMarkdown escapes HTML by default


Test 31: HTML Comment with XSS
-------------------------------
<!-- <script>console.log('XSS')</script> -->

Expected: âœ… Renders as: "<!-- <script>console.log('XSS')</script> -->"
Reason: ReactMarkdown escapes HTML by default


Test 32: Data URI Image
------------------------
<img src="data:image/svg+xml,<svg onload=console.log('XSS')>">

Expected: âœ… Renders as: "<img src="data:image/svg+xml,<svg onload=console.log('XSS')>">"
Reason: ReactMarkdown escapes HTML by default


Test 33: Event Handler Attributes
----------------------------------
<div onload=console.log('XSS')>Test</div>
<span onclick=console.log('XSS')>Test</span>
<p onmouseover=console.log('XSS')>Test</p>

Expected: âœ… All rendered as literal text (not executed)
Reason: ReactMarkdown escapes HTML by default


Test 34: CSS Expression (IE specific)
--------------------------------------
<div style="width: expression(console.log('XSS'));">Test</div>

Expected: âœ… Renders as: "<div style="width: expression(console.log('XSS'));">Test</div>"
Reason: ReactMarkdown escapes HTML by default


Test 35: Nested Script Tags
----------------------------
<script><script>console.log('XSS')</script></script>

Expected: âœ… Renders as: "<script><script>console.log('XSS')</script></script>"
Reason: ReactMarkdown escapes HTML by default


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SECTION 3: LEGITIMATE USE CASES (Should Work)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Test 36: User Mention
----------------------
Hey @<Qm123456789> how are you?

Expected: âœ… Renders with styled mention span
Reason: Our code generates <span> which is whitelisted


Test 37: @everyone Mention
---------------------------
@everyone please check this

Expected: âœ… Renders with styled @everyone span
Reason: Our code generates <span> which is whitelisted


Test 38: Role Mention
----------------------
@moderators can you help?

Expected: âœ… Renders with styled role mention span
Reason: Our code generates <span> which is whitelisted


Test 39: Regular Markdown
--------------------------
**bold** *italic* `code` ~~strikethrough~~

Expected: âœ… Renders with proper markdown formatting
Reason: Standard markdown is safe


Test 40: Code Block
--------------------
```javascript
function test() {
  console.log("This is code");
}
```

Expected: âœ… Renders as formatted code block
Reason: Code blocks are safe


Test 41: Markdown Links
------------------------
Check out [this link](https://example.com)

Expected: âœ… Renders as clickable link
Reason: Markdown links processed safely


Test 42: Standalone YouTube URL
--------------------------------
https://www.youtube.com/watch?v=dQw4w9WgXcQ

Expected: âœ… Renders as embedded video
Reason: Our YouTube processing handles this


Test 43: Inline YouTube URL
----------------------------
Check this video https://www.youtube.com/watch?v=dQw4w9WgXcQ out!

Expected: âœ… Renders as clickable link (not embed)
Reason: Inline detection works correctly


Test 44: Markdown Image (User-typed)
-------------------------------------
![my cat](https://example.com/cat.jpg)

Expected: âœ… Renders as nothing (blocked)
Reason: img handler returns null for non-YouTube images


Test 45: Tables in Markdown
----------------------------
| Column 1 | Column 2 |
|----------|----------|
| Data 1   | Data 2   |

Expected: âœ… Renders as formatted table
Reason: Tables are safe markdown


Test 46: Lists
--------------
1. First item
2. Second item
3. Third item

- Bullet one
- Bullet two

Expected: âœ… Renders as formatted lists
Reason: Lists are safe markdown


Test 47: Blockquotes
--------------------
> This is a quote
>
> Multi-line quote

Expected: âœ… Renders as formatted blockquote
Reason: Blockquotes are safe


Test 48: Headers (H3 only)
---------------------------
### This is a header

Expected: âœ… Renders as H3 (H1/H2 converted to H3)
Reason: Only H3 allowed


Test 49: Horizontal Rules
--------------------------
Some text
---
More text

Expected: âœ… Renders with horizontal line
Reason: HR is safe


Test 50: Mixed Content
-----------------------
Hey @<Qm123456> check **this** out:

```
code here
```

And also: https://youtube.com/watch?v=test

Expected: âœ… All components render correctly
Reason: All safe markdown elements


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SECTION 4: EDGE CASES & ADVANCED ATTACKS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Test 51: HTML Entity Encoding
------------------------------
&lt;script&gt;console.log('XSS')&lt;/script&gt;

Expected: âœ… Renders as literal text (entities decoded but tag stripped)
Reason: Even if decoded, <script> is stripped by sanitizer


Test 52: Unicode Escaping
--------------------------
\u003cscript\u003econsole.log('XSS')\u003c/script\u003e

Expected: âœ… Renders as literal text
Reason: JavaScript unicode escapes don't work in HTML context


Test 53: Double Encoding
-------------------------
%253Cscript%253Econsole.log('XSS')%253C/script%253E

Expected: âœ… Renders as literal text
Reason: URL encoding doesn't create HTML tags


Test 54: NULL Byte Injection
-----------------------------
<scr\x00ipt>console.log('XSS')</script>

Expected: âœ… Tag stripped if parsed, or rendered as text
Reason: Sanitizer handles malformed tags


Test 55: Case Variation
------------------------
<ScRiPt>console.log('XSS')</sCrIpT>

Expected: âœ… Tag stripped
Reason: Sanitizer is case-insensitive


Test 56: HTML5 Tags
--------------------
<details open><summary>Click</summary><script>console.log('XSS')</script></details>

Expected: âœ… All tags stripped
Reason: Not in whitelist


Test 57: Markdown + HTML Mix
-----------------------------
**Bold** <script>console.log('XSS')</script> *italic*

Expected: âœ… Renders as: "Bold <script>console.log('XSS')</script> italic"
Reason: Markdown works, HTML escaped as literal text


Test 58: Nested Attributes
---------------------------
<span title="<script>console.log('XSS')</script>">Test</span>

Expected: âœ… Renders as: "<span title="<script>console.log('XSS')</script>">Test</span>"
Reason: ReactMarkdown escapes HTML by default


Test 59: Data Protocol in Image
--------------------------------
![test](data:text/html,<script>console.log('XSS')</script>)

Expected: âœ… Nothing renders (blocked)
Reason: img handler blocks non-YouTube images (returns null)


Test 60: Multiple Vectors Combined
-----------------------------------
<div><script>console.log('1')</script><img src=x onerror=console.log('2')><style>body{background:red}</style></div>

Expected: âœ… Renders as literal text (all HTML escaped)
Reason: ReactMarkdown escapes HTML by default


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TESTING CHECKLIST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â–¡ Input Validation Layer
  â–¡ Test 1-10: All blocked by validation (display name / space name inputs)
  â–¡ Test 11-18: All accepted by validation (safe characters)

â–¡ HTML Escaping Layer (ReactMarkdown without rehype-raw)
  â–¡ Test 19-35: All HTML tags escaped as literal text in messages
  â–¡ No console.log() messages appear in browser console
  â–¡ No layout changes or red backgrounds appear
  â–¡ HTML appears as visible text (e.g., "<script>alert(1)</script>" shows on screen)

â–¡ Legitimate Functionality
  â–¡ Test 36-38: Mentions render correctly with styling (via placeholder tokens)
  â–¡ Test 39-50: All markdown features work as expected

â–¡ Edge Cases
  â–¡ Test 51-60: Advanced attacks all escaped as literal text

â–¡ Browser Console Check
  â–¡ Open browser dev tools â†’ Console tab
  â–¡ Type test messages
  â–¡ Verify NO "XSS" or attack messages appear in console

â–¡ Network Tab Check
  â–¡ Open browser dev tools â†’ Network tab
  â–¡ Verify no unexpected requests to "evil.com" or data URIs

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
HOW TO TEST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. DISPLAY NAME / SPACE NAME TESTS:
   - Go to User Settings â†’ General
   - Try pasting Test 1-18 into the display name field
   - Verify validation errors for Test 1-10
   - Verify acceptance for Test 11-18

2. MESSAGE TESTS:
   - Open a space/channel
   - Type Test 19-60 into the message input
   - Send the message
   - Verify expected behavior (stripped HTML, working markdown)

3. VERIFICATION:
   - Open browser DevTools (F12)
   - Check Console tab: Should see NO "XSS" messages
   - Check Network tab: Should see NO requests to evil.com
   - Check Elements tab: Inspect rendered HTML, should see only <span> from mentions

4. SUCCESS CRITERIA:
   âœ… All validation tests (1-10) show error messages
   âœ… All safe characters (11-18) are accepted
   âœ… All malicious HTML (19-35) is stripped from messages
   âœ… All legitimate features (36-50) work correctly
   âœ… All edge cases (51-60) are handled safely
   âœ… Browser console shows zero XSS attempts executed

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
WHAT TO LOOK FOR (Signs of Successful Attack - Should NOT Happen!)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âŒ Console logs appearing with "XSS" messages
âŒ Alert boxes popping up
âŒ Background color changing to red
âŒ Network requests to evil.com or unknown domains
âŒ JavaScript execution in attributes
âŒ Ability to inject <script>, <img>, <iframe>, etc. tags
âŒ Ability to use < > " ' characters in display/space names

If ANY of the above happen, the security implementation has failed!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
NOTES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

- All test snippets use console.log() instead of alert() for less disruption
- Tests are designed to be safe for local testing
- No actual malicious payloads that could cause damage
- Focus is on validating the security layers work as designed
- Run tests in localhost only, not in production

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Document Created: 2025-11-08
Last Updated: 2025-11-08
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
