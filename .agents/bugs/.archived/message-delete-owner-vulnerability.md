---
type: bug
title: 'Role with message:delete permission can delete space owner''s messages'
status: archived
ai_generated: true
created: 2026-01-09T00:00:00.000Z
updated: '2026-01-09'
---

# Role with message:delete permission can delete space owner's messages

> **⚠️ AI-Generated**: May contain errors. Verify before use.

## Symptoms
A user with `message:delete` role permission can delete any user's messages, including the space owner's messages. Once deleted, messages are permanently gone with no recovery path.

## Root Cause
The receive-side validation in `MessageService.ts` (lines 797-886) checks if the sender has `message:delete` permission but does not verify whether the target message belongs to the space owner.

Due to privacy constraints, other clients cannot identify who the space owner is (owner identity is intentionally hidden), making receive-side owner protection impossible without revealing owner identity.

## Impact
- **Severity**: Medium-High
- **Permanent data loss**: Deleted messages cannot be recovered
- **Trust model**: Space owners must carefully control who gets `message:delete` permission

## Potential Solutions
1. **Accept as design trade-off** - Document that delete permission requires high trust
2. **Owner self-protection** - Owner's client ignores delete requests for own messages (partial mitigation)
3. **Message tombstones** - Keep deleted message metadata for owner to restore (complex)

## Related
- Same pattern exists for `user:mute` but mute is recoverable (owner can unmute self)
- File: `src/services/MessageService.ts:797-886`

---
